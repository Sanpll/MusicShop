<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Корзина</title>
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
  >
  <meta
    http-equiv="X-UA-Compatible"
    content="ie=edge"
  >
  <link
    rel="stylesheet"
    href="../../static/styles/styles.css"
  >
</head>

<body>
<section class="section container cart">
  <h1 class="h2">Корзина</h1>
  <div
    th:if="${improvedQuantities == true}"
    class="auth__error"
  >
    Количество некоторых товаров скорректировано с учётом оставшегося количества на складе.
  </div>
  <div
    class="cart__list-wrapper"
    th:if="${not #lists.isEmpty(cartItems)}"
  >
    <ul
      class="cart__list"
    >
      <li
        class="list__item"
        th:each="cartItem : ${cartItems}"
      >
        <div class="cart-card">
          <div class="cart-card__image-wrapper">
            <img
              class="cart-card__image"
              th:src="@{'/images/products/' + ${cartItem.productImageFilename ?: 'no_image.png'}}"
              th:alt="${cartItem.productImageFilename != null ? cartItem.productName : 'Нет изображения'}"
              width="250px"
              height=""
              loading="lazy"
            />
          </div>
          <h2
            class="cart-card__title h3"
            th:text="${cartItem.productName}"
          ></h2>
          <div class="cart-card__controls">
            <div class="cart-card__choose-quantity">
              <form
                method="post"
                th:action="@{/cart/decrement-product/{id}(id=${cartItem.productId})}"
              >
                <button
                  type="submit"
                  class="button button--decrement"
                >
                  -
                </button>
              </form>
              <div th:text="${cartItem.quantity}"></div>
              <form
                method="post"
                th:action="@{/cart/increment-product/{id}(id=${cartItem.productId})}"
              >
                <button
                  type="submit"
                  class="button button--increment"
                >
                  +
                </button>
              </form>
            </div>
            <div
              class="cart-card__price"
            >
              <p th:text="${cartItem.productPrice * cartItem.quantity} + ' ₽'"></p>
            </div>
            <div class="cart-card__delete">
              <form
                method="post"
                th:action="@{/delete/product}"
                class="form"
              >
                <input
                  type="hidden"
                  name="productId"
                  th:value="${cartItem.productId}"
                >
                <button
                  type="submit"
                  class="button button-submit button--delete"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    height="24px"
                    viewBox="0 -960 960 960"
                    width="24px"
                    fill="currentColor"
                  >
                    <path d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z" />
                  </svg>
                </button>
              </form>
            </div>
          </div>
        </div>
      </li>
    </ul>
  </div>

  <div
    th:if="${#lists.isEmpty(cartItems)}"
    class="empty-message"
  >
    Корзина пустая :(
  </div>

  <div class="link__wrapper">
    <a
      class="link"
      href="/check-order"
    >Оформить заказ
    </a>
  </div>
</section>
</body>
</html>